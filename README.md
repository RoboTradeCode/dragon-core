# Test Core Python
## Ядро для тестирования гейтов

Ядро предназначено для тестирования гейтов. Его запуск осуществляется через простой CLI-интерфейс, есть несколько типов тестирования. Ядро написано на Python3.10 с использованием библиотека aeron-python и click. 

### Типы тестирования

####  Fast Test

Тип тестирования, при котором ядро **прогоняет все команды** и тестирует выставление и отмену ордеров, получение баланса и ордербуков. То есть тестируется **весь функционал**, но максимально **быстро**. Данный тест будет использоваться при **незначительных изменениях** гейта для **проверки его работоспособности**.     

Обозначаенися в cli как `fast-test`

####  Long Test

 При этом тестировании ядро запускается на **продолжительное время** (несколько дней) и реализует простую безубыточную **торговую стратегию**. Основная цель такого тестирования - проверить, как **гейт конкретной биржи** ведет себя при **продолжительном запуске**. Тест будет использоваться для проверки новых гейтов, гейтов со  значительными изменениями или для гейтов, адаптированных под новые  биржи.

Обозначаенися в cli как `long-test`

#### Listener

Режим запуска ядра, при котором оно не будет отправлять команды, а будет только получать сообщения от гейта и логгировать их. По сути, это не является тестом, а особым режимом работы ядра.

Обозначаенися в cli как `listener`

## Установка

1. Установка python 3.10:
    ```bash
    sudo apt update && sudo apt upgrade -y
    sudo apt install software-properties-common -y
    sudo add-apt-repository ppa:deadsnakes/ppa -y
    sudo apt install python3.10 python3.10-dev python3.10-venv
    ```

2. Клонирование репозитория с исходным кодом ядра:
	```bash
	git clone https://github.com/RoboTradeCode/test-core-python.git
	```
	
3. Установка виртуального окружения venv:
	```bash
	cd test-core-python
	python3.10 -m venv venv
	```
4. Активация виртуального окружения:
	```bash
	source venv/bin/activate
	```

5. Установка зависимостей ядра:
	```bash
	pip install -r requirements.txt
	```
6. Добавление права на запуск:

	```bash
	sudo chmod +x run_test_core.py
	```

7. Основные этапы установки завершены. Также для работы ядра потребуется Aeron. На момент запуска должен быть запущен Media Drive Aeron. Он может быть запущен как в качестве systemd, так и в качестве процесса (т.е. запущен в терминале). Инстркуции по сборке и запуску Aeron можно найти в вики [aeron-python](https://github.com/RoboTradeCode/aeron-python/wiki/%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-Aeron).

8. Рекомендую запустить ядро в целях проверки:
	```bash
	python run_test_core.py listener binance
	```
	
## Использование
Тестовое ядро реализует несложный интерфейс команной строки. Запуск ядра в определенном режиме (см. типы тестирования) можно выполнить с помощью команд такого формата:

```bash
./run_test_core.py <тип тестирования> <название биржи>
```

Например:
```bash
./run_test_core.py fast-test binance
```
```bash
./run_test_core.py listener okx
```
```bash
./run_test_core.py long-test ftx
```

При выполнении такой команды в терминале, будет запущено тестовое ядро. Вывод логов будет осуществляться в этот  же терминал. Остановить ядро можно с помощью прерывания Ctrl + C.

### Справка
